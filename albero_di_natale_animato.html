<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Buon Natale Giulia</title>
<style>
html,body{
  margin:0; padding:0; width:100%; height:100%; overflow:hidden;
  background:radial-gradient(circle at top,#0b1d33,#02040a);
  font-family:'Segoe UI',sans-serif; color:white;
}
canvas{display:block}

#message{
  position:absolute;
  left:50%; top:50%; transform:translate(-50%,-50%) translateY(40px) scale(.95);
  padding:22px 44px;
  font-size:clamp(2.6rem,6vw,4.4rem);
  font-weight:700; letter-spacing:2px;
  opacity:0;
  background:linear-gradient(120deg,rgba(10,40,80,.9),rgba(20,80,120,.9));
  border-radius:34px;
  box-shadow:0 0 45px rgba(120,200,255,.7);
  animation:showText 3s ease-out forwards, bgMove 6s linear infinite;
  animation-delay:13s,13s;
  text-shadow:0 0 24px rgba(255,255,255,.95);
}
@keyframes showText{to{opacity:1;transform:translate(-50%,-50%)}}
@keyframes bgMove{
  0%{background-position:0% 50%}
  100%{background-position:200% 50%}
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="message">ðŸŽ„ Buon Natale Giulia ðŸŽ„</div>

<script>
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
addEventListener('resize',resize); resize();

const CX=()=>canvas.width/2;
const BASE=()=>canvas.height*0.9;

// ================= NEVE =================
const snow=[];
for(let i=0;i<220;i++){
  snow.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:1+Math.random()*2,s:0.5+Math.random()*1.5});
}
function drawSnow(){
  ctx.fillStyle='white';
  snow.forEach(f=>{
    f.y+=f.s; if(f.y>canvas.height) f.y=0;
    ctx.beginPath(); ctx.arc(f.x,f.y,f.r,0,6.28); ctx.fill();
  });
}

// ================= SPIRALE 3D =================
let ribbon=[],decor=[],progress=0;
function createSpiral(){
  ribbon=[]; decor=[];
  const turns=9, steps=1200, height=canvas.height*0.7;
  for(let i=0;i<steps;i++){
    const t=i/steps;
    const ang=t*Math.PI*2*turns;
    const r=(1-t)*canvas.width*0.38;
    const depth=Math.sin(ang)*0.5+0.5;
    const x=CX()+Math.cos(ang)*r;
    const y=BASE()-t*height;
    ribbon.push({x,y,depth});
    if(Math.random()<0.08) decor.push({x,y,depth,r:3+Math.random()*2,h:Math.random()*360,p:Math.random()*6});
  }
}

// ================= AEREO (2D MIGLIORATO) =================
function drawPlane(x,y,scale){
  ctx.save(); ctx.translate(x,y); ctx.scale(scale,scale);

  // fusoliera
  const bodyGrad=ctx.createLinearGradient(-30,0,30,0);
  bodyGrad.addColorStop(0,'#e6e6e6');
  bodyGrad.addColorStop(1,'#bdbdbd');
  ctx.fillStyle=bodyGrad;
  ctx.beginPath(); ctx.ellipse(0,0,32,7,0,0,Math.PI*2); ctx.fill();

  // ali
  ctx.fillStyle='#cfcfcf';
  ctx.beginPath(); ctx.moveTo(-6,0); ctx.lineTo(-42,-14); ctx.lineTo(-38,-4); ctx.closePath(); ctx.fill();
  ctx.beginPath(); ctx.moveTo(-6,0); ctx.lineTo(-42,14); ctx.lineTo(-38,4); ctx.closePath(); ctx.fill();

  // coda
  ctx.fillStyle='#b0b0b0'; ctx.fillRect(22,-11,6,22);

  // finestrino
  ctx.fillStyle='rgba(80,160,220,.8)'; ctx.beginPath(); ctx.arc(6,-2,3,0,6.28); ctx.fill();

  // elica
  ctx.strokeStyle='rgba(200,200,200,.8)'; ctx.lineWidth=2;
  ctx.beginPath(); ctx.moveTo(32,-6); ctx.lineTo(32,6); ctx.stroke();

  ctx.restore();
}

// ================= STELLA CADENTE =================

let starProgress=0;
function drawFallingStar(){
  if(progress<1) return;
  starProgress=Math.min(starProgress+0.012,1);
  const startX=CX()+canvas.width*0.45;
  const startY=-140;
  const endX=CX();
  const endY=BASE()-canvas.height*0.7;
  const x=startX+(endX-startX)*starProgress;
  const y=startY+(endY-startY)*starProgress;

  // scia
  ctx.strokeStyle='rgba(255,230,150,.6)';
  ctx.lineWidth=3;
  ctx.beginPath(); ctx.moveTo(x-60,y-60); ctx.lineTo(x,y); ctx.stroke();

  // stella
  ctx.save(); ctx.translate(x,y);
  const g=ctx.createRadialGradient(0,0,2,0,0,50);
  g.addColorStop(0,'#ffffff');
  g.addColorStop(.6,'#ffe9a3');
  g.addColorStop(1,'rgba(255,215,0,0)');
  ctx.fillStyle=g;
  ctx.beginPath();
  for(let i=0;i<5;i++){ctx.lineTo(0,-32);ctx.rotate(Math.PI/5);ctx.lineTo(0,32);ctx.rotate(Math.PI/5)}
  ctx.fill(); ctx.restore();

  // esplosione di luce in cima all'albero
  if(starProgress>0.98){
    const glow=ctx.createRadialGradient(endX,endY,10,endX,endY,180);
    glow.addColorStop(0,'rgba(255,240,200,.9)');
    glow.addColorStop(.5,'rgba(180,255,220,.35)');
    glow.addColorStop(1,'rgba(0,0,0,0)');
    ctx.fillStyle=glow;
    ctx.beginPath(); ctx.arc(endX,endY,180,0,6.28); ctx.fill();
  }
}

// ================= DISEGNO =================
function drawRibbon(){
  const max=Math.floor(ribbon.length*progress);
  for(let i=1;i<max;i++){
    const p=ribbon[i],pp=ribbon[i-1];
    ctx.strokeStyle=`rgba(12,105,75,${0.45+0.55*p.depth})`;
    ctx.lineWidth=14+14*p.depth;
    ctx.lineCap='round';
    ctx.beginPath(); ctx.moveTo(pp.x,pp.y); ctx.lineTo(p.x,p.y); ctx.stroke();
  }

  if(max>5){ const p=ribbon[max-1]; drawPlane(p.x,p.y,0.8+0.4*p.depth); }

  if(progress>0.95){
    decor.forEach(d=>{
      d.p+=0.06;
      const glow=(Math.sin(d.p)+1)/2;
      ctx.fillStyle=`hsla(${d.h},100%,70%,${.4+glow*.6})`;
      ctx.beginPath(); ctx.arc(d.x,d.y,d.r+glow*2,0,6.28); ctx.fill();
    });
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(progress<1) progress+=0.0016;
  drawSnow();
  drawRibbon();
  drawFallingStar();
  requestAnimationFrame(animate);
}

createSpiral(); animate();
</script>
</body>
</html>
